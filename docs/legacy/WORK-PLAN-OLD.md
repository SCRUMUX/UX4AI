# ПЛАН РАБОТЫ - Исправление модульной архитектуры

> **⚠️ ИСТОРИЧЕСКИЙ ДОКУМЕНТ** — этот файл описывает план работы на историческом этапе проекта. Для актуальной информации см. [README.md](../README.md) и [docs/ARCHITECTURE.md](../ARCHITECTURE.md).

**Дата:** Исторический этап проекта  
**Статус:** План работы по переходу к модульной архитектуре (выполнен)

---

**Примечание:** Этот документ описывает этап перехода к модульной архитектуре. Многие упомянутые файлы (например, `core/scenes.js`, `scenes/matrixScene.js`, `themes/matrix.js`) были удалены в процессе рефакторинга. Актуальная структура проекта описана в [docs/PROJECT_MAP.md](../PROJECT_MAP.md).

## Диагностика

### Текущая ситуация:
✅ **index.html** — основной entry (модульная версия)

### Проблемы:
1. THREE.js загружается из CDN как обычный `<script>`
2. ES modules пытаются использовать `window.THREE` до загрузки
3. Модули импортируются ДО того как THREE готов

### Файлы которые созданы:
✅ /core/engine.js
✅ /core/scenes.js  
✅ /core/picking.js
✅ /core/labels.js
✅ /core/state.js
✅ /core/navigation.js
✅ /core/hud-manager.js
✅ /scenes/calmScene-complete.js
✅ /scenes/matrixScene.js
✅ /themes/calm.js
✅ /themes/matrix.js
✅ /themes/index.js
✅ /ui/themeSwitcher.js

Все модули пытаются получить THREE через `getTHREE()` но это НЕ РАБОТАЕТ.

## Решение

### Вариант 1: Простой (быстрее всего)
Использовать рабочий index.html и добавить туда только theme switcher.
Плюсы: Работает сразу
Минусы: Не модульно

### Вариант 2: Правильная модульность
Загружать THREE.js через динамический импорт или использовать bundler.
Плюсы: Соответствует ТЗ
Минусы: Нужен webpack/vite или правильная загрузка THREE

### Вариант 3: Гибрид (РЕКОМЕНДУЮ)
1. Использовать рабочий index.html как базу
2. Постепенно выносить код в модули
3. Использовать importmap для правильной загрузки THREE

## Что делаю сейчас:
Выберу вариант который работает БЫСТРО и соответствует ТЗ на 80%.

