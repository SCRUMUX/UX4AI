# –ê—É–¥–∏—Ç –∫–æ–¥–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º –ø—Ä–∞–≤–∏–ª–∞–º

**–í–µ—Ä—Å–∏—è:** –§–∞–∑–∞ 7 ‚Äî –§–∏–Ω–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Ñ–∏–∫—Å–∞—Ü–∏—è  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2024  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –§–∞–∑–∞ 7 ‚Äî –û–±–Ω–æ–≤–ª–µ–Ω–æ: –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, —Å–∏—Å—Ç–µ–º–∞ —Ç–µ–º, –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–æ–¥—É–ª–∏  
**–ë–∞–∑–æ–≤—ã–π baseline:** dev-–≤–µ—Ç–∫–∞ (—Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ê–ö–¢–£–ê–õ–¨–ù–´–ô –ê–£–î–ò–¢** ‚Äî —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –∞—É–¥–∏—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

> ‚ö†Ô∏è **–í–ê–ñ–ù–û:** –î—É–±–ª–∏–∫–∞—Ç `doc/ARCHITECTURE_AUDIT.md` —É–¥–∞–ª—ë–Ω. –≠—Ç–æ—Ç —Ñ–∞–π–ª (`docs/ARCHITECTURE_AUDIT.md`) —è–≤–ª—è–µ—Ç—Å—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–º –∞—É–¥–∏—Ç–æ–º.

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: —É–±—Ä–∞–Ω–Ω—ã–µ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (–§–∞–∑–∞ 7)

### ‚úÖ –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

**–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**
- ‚úÖ `docs/ARCHITECTURE.md` ‚Äî –º–∞—Å—Ç–µ—Ä-–¥–æ–∫—É–º–µ–Ω—Ç –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ `ARCHITECTURE.md` (root) ‚Äî –∫—Ä–∞—Ç–∫–∏–π "—à–æ—Ä—Ç–∫–∞—Ç" —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ `docs/ARCHITECTURE.md`

**–£–±—Ä–∞–Ω–Ω—ã–µ/–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã:**
- ‚úÖ `doc/ARCHITECTURE_AUDIT.md` ‚Üí –ø–µ—Ä–µ–º–µ—â—ë–Ω –≤ `docs/legacy/ARCHITECTURE_AUDIT-DUPLICATE.md` (–§–∞–∑–∞ 2)
- ‚úÖ `WORK-PLAN.md` ‚Üí –ø–µ—Ä–µ–º–µ—â—ë–Ω –≤ `docs/legacy/WORK-PLAN-OLD.md` (–§–∞–∑–∞ 2)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–æ–ª—å—à–µ –Ω–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã ‚Äî `docs/ARCHITECTURE.md`.

### ‚úÖ –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ —Ç–µ–º–∞–º

**–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏—Å—Ç–∏–Ω—ã –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —Ç–µ–º:**
- ‚úÖ `THEME-SYSTEM.md` ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã —Ç–µ–º
- ‚úÖ `THEME-CUSTOMIZATION-GUIDE.md` ‚Äî —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Ç–µ–º
- ‚úÖ `docs/COLOR_MAP.md` ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ü–≤–µ—Ç–æ–≤—ã–º —Ç–æ–∫–µ–Ω–∞–º

**–£–±—Ä–∞–Ω–Ω—ã–µ/–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã:**
- ‚úÖ `THEME-ARCHITECTURE.md` ‚Üí –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ `LEGACY` —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º –∏ —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (–§–∞–∑–∞ A)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–æ–ª—å—à–µ –Ω–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ —Ç–µ–º–∞–º. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏—Å—Ç–∏–Ω—ã ‚Äî `THEME-SYSTEM.md`, `THEME-CUSTOMIZATION-GUIDE.md`, `docs/COLOR_MAP.md`.

### ‚úÖ –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è README —Ñ–∞–π–ª–æ–≤

**–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ README:**
- ‚úÖ `README.md` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π README —Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- ‚úÖ `README-SUCCESS.md` ‚Äî –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –¥–æ–∫—É–º–µ–Ω—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ç–µ–º

**–£–±—Ä–∞–Ω–Ω—ã–µ/–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ README:**
- ‚úÖ –í—Å–µ `README-*` —Ñ–∞–π–ª—ã (–∫—Ä–æ–º–µ `README.md` –∏ `README-SUCCESS.md`) ‚Üí –ø–µ—Ä–µ–º–µ—â–µ–Ω—ã –≤ `docs/legacy/` (–§–∞–∑–∞ A):
  - `README-ALL-THEMES.md`
  - `README-FINAL.md`
  - `README-FIXED.md`
  - `README-MODULAR.md`
  - `README-NEON-CUBES.md`
  - `README-THEME-ENGINE-PROGRESS.md`
  - `README-THEME-ENGINE.md`
  - `README-THEMES.md`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–æ–ª—å—à–µ –Ω–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö README —Ñ–∞–π–ª–æ–≤. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–∫—Ç—É–∞–ª—å–Ω—ã–π README ‚Äî `README.md`.

---

## üé® –°–∏—Å—Ç–µ–º–∞ —Ç–µ–º: –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏—Å—Ç–∏–Ω—ã (–§–∞–∑–∞ 7)

### ‚úÖ Runtime-–∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Ü–≤–µ—Ç–æ–≤

**–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ runtime-–∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Ü–≤–µ—Ç–æ–≤:**
- ‚úÖ `core/theme-colors.js` ‚Äî JavaScript-–º–æ–¥—É–ª—å —Å —Ü–≤–µ—Ç–∞–º–∏ –¥–ª—è 3D-—Å—Ü–µ–Ω—ã –∏ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–º–∏ UI-—Ç–æ–∫–µ–Ω–∞–º–∏
- ‚úÖ `themes/ui-theme-config.js` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Dark/Light —Ç–µ–º (CSS-–∫–ª–∞—Å—Å—ã, meta-—Ç–µ–≥–∏)
- ‚úÖ `ui/theme-controller.js` ‚Äî –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º (`applyThemeById()`)
- ‚úÖ `styles/tokens.css` ‚Äî CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–º–∞–ø–ø—è—Ç—Å—è –Ω–∞ —Ç–æ–∫–µ–Ω—ã –∏–∑ `core/theme-colors.js`)

**–ü—Ä–∞–≤–∏–ª–æ:** –í—Å–µ —Ü–≤–µ—Ç–∞ –¥–æ–ª–∂–Ω—ã –±—Ä–∞—Ç—å—Å—è –∏–∑ —ç—Ç–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤. –ù–∏–∫–∞–∫–∏–µ –¥—Ä—É–≥–∏–µ –º–æ–¥—É–ª–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ —Ü–≤–µ—Ç–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã.

### ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ü–≤–µ—Ç–∞–º

**–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ —Ü–≤–µ—Ç–∞–º:**
- ‚úÖ `docs/COLOR_MAP.md` ‚Äî –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ü–≤–µ—Ç–æ–≤—ã–º —Ç–æ–∫–µ–Ω–∞–º, –∏—Ö —Ä–æ–ª—è–º –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

**–ü—Ä–∞–≤–∏–ª–æ:** –õ—é–±—ã–µ –Ω–æ–≤—ã–µ —Ü–≤–µ—Ç–∞ –¥–æ–ª–∂–Ω—ã —Å–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –≤ `docs/COLOR_MAP.md`, –∑–∞—Ç–µ–º –≤ `core/theme-colors.js` –∏ `styles/tokens.css`.

### ‚ùå Legacy —Ñ–∞–π–ª—ã (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è)

**Legacy CSS —Ñ–∞–π–ª—ã (–ø–µ—Ä–µ–º–µ—â–µ–Ω—ã –≤ `themes/legacy/`):**
- ‚ùå `themes/legacy/theme-variables.css` ‚Äî —Å—Ç–∞—Ä—ã–µ CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- ‚ùå `themes/legacy/simple-themes.css` ‚Äî –ø—Ä–æ—Å—Ç—ã–µ —Ç–µ–º—ã (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

**Legacy alias-—Å–ª–æ–π (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏):**
- ‚ö†Ô∏è `styles/variables.css` ‚Äî —Ç–æ–Ω–∫–∏–π alias-—Å–ª–æ–π, –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –º–∞–ø–ø—è—Ç—Å—è –Ω–∞ —Ç–æ–∫–µ–Ω—ã –∏–∑ `styles/tokens.css` (–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–∏—Å—Ç–µ–º–∞ —Ç–µ–º –æ–ø–∏—Ä–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ `core/theme-colors.js` + `themes/ui-theme-config.js` + `ui/theme-controller.js` + `styles/tokens.css`. Legacy —Ñ–∞–π–ª—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ runtime.

---

## üóëÔ∏è –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–æ–¥—É–ª–∏: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞—É–¥–∏—Ç–∞ (–§–∞–∑–∞ 7)

### ‚úÖ –£–¥–∞–ª—ë–Ω–Ω—ã–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–æ–¥—É–ª–∏ (–§–∞–∑–∞ 5)

**–£–¥–∞–ª—ë–Ω–Ω—ã–µ JavaScript –º–æ–¥—É–ª–∏:**
- ‚úÖ `utils/cyber_materials.js` ‚Üí –ø–µ—Ä–µ–º–µ—â—ë–Ω –≤ `archive/cyber_materials.js` (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞)

**–£–¥–∞–ª—ë–Ω–Ω—ã–µ –º–µ–¥–∏–∞-—Ñ–∞–π–ª—ã:**
- ‚úÖ `Cfmerapath.svg` ‚Üí –ø–µ—Ä–µ–º–µ—â—ë–Ω –≤ `archive/Cfmerapath.svg` (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- ‚úÖ `wallpaper_24dp_434343_FILL0_wght400_GRAD0_opsz24.svg` ‚Üí –ø–µ—Ä–µ–º–µ—â—ë–Ω –≤ `archive/wallpaper_24dp_434343_FILL0_wght400_GRAD0_opsz24.svg` (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- ‚úÖ `Matrix.glb` ‚Üí –ø–µ—Ä–µ–º–µ—â—ë–Ω –≤ `archive/Matrix.glb` (3D –º–æ–¥–µ–ª—å –¥–ª—è —É–¥–∞–ª—ë–Ω–Ω–æ–π Matrix-—Å—Ü–µ–Ω—ã)
- ‚úÖ `path.glb` ‚Üí –ø–µ—Ä–µ–º–µ—â—ë–Ω –≤ `archive/path.glb` (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- ‚úÖ `crosshair-blue.ani` ‚Üí –ø–µ—Ä–µ–º–µ—â—ë–Ω –≤ `archive/crosshair-blue.ani` (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

**–£–¥–∞–ª—ë–Ω–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏:**
- ‚úÖ `utils/` ‚Üí —É–¥–∞–ª—ë–Ω (–ø–æ—Å–ª–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è `cyber_materials.js` –≤ `archive/`)

**–£–¥–∞–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã-–º—É—Å–æ—Ä:**
- ‚úÖ `tatus` ‚Üí —É–¥–∞–ª—ë–Ω (junk —Ñ–∞–π–ª)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –º–æ–¥—É–ª–µ–π. –í—Å–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–º–µ—â–µ–Ω—ã –≤ `archive/` –∏–ª–∏ —É–¥–∞–ª–µ–Ω—ã.

### ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è)

**–Ø–¥—Ä–æ 3D-–¥–≤–∏–∂–∫–∞ (`core/`):**
- ‚úÖ `engine.js` ‚Äî –≥–ª–∞–≤–Ω—ã–π –¥–≤–∏–∂–æ–∫ (Three.js, renderer, camera, scene)
- ‚úÖ `hud-manager.js` ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä HUD-–ø–∞–Ω–µ–ª–µ–π
- ‚úÖ `labels.js` ‚Äî 2D-–º–µ—Ç–∫–∏ –ø–æ–≤–µ—Ä—Ö 3D-—Å—Ü–µ–Ω—ã
- ‚úÖ `navigation.js` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–º–µ—Ä–æ–π (—Å–∫—Ä–æ–ª–ª, –æ—Ä–±–∏—Ç–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º)
- ‚úÖ `picking.js` ‚Äî raycasting –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å 3D-–æ–±—ä–µ–∫—Ç–∞–º–∏
- ‚úÖ `sections.js` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –º–∞–ø–ø–∏–Ω–≥ —Å–µ–∫—Ü–∏–π
- ‚úÖ `state.js` ‚Äî –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ event bus
- ‚úÖ `theme-colors.js` ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ü–≤–µ—Ç–æ–≤

**UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (`ui/`):**
- ‚úÖ `theme-controller.js` ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Ç–µ–º
- ‚úÖ `themeSwitcher.js` ‚Äî UI-–æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç–µ–º (`themes/`):**
- ‚úÖ `calm.js` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ü–µ–Ω—ã "Calm"
- ‚úÖ `index.js` ‚Äî —Ä–µ–µ—Å—Ç—Ä —Å—Ü–µ–Ω
- ‚úÖ `ui-theme-config.js` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ UI-—Ç–µ–º (dark/light)

**3D-—Å—Ü–µ–Ω—ã (`scenes/`):**
- ‚úÖ `calmScene-complete.js` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è 3D-—Å—Ü–µ–Ω–∞ "Calm"

**–î–∞–Ω–Ω—ã–µ (`data/`):**
- ‚úÖ `nodes-data-complete.js` ‚Äî –¥–∞–Ω–Ω—ã–µ —É–∑–ª–æ–≤ 3D-—Å—Ü–µ–Ω—ã

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –º–æ–¥—É–ª–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è. –ù–µ—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –º–æ–¥—É–ª–µ–π.

---

---

## –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 1: –û–¥–Ω–∞ —Å—Ü–µ–Ω–∞, —Ç–µ–º—ã —Å—Ü–µ–Ω—É –Ω–µ –ø–æ–¥–º–µ–Ω—è—é—Ç

**–ü—Ä–∞–≤–∏–ª–æ:** –¢–µ–º—ã –Ω–µ —Å–æ–∑–¥–∞—é—Ç —Å–≤–æ–∏ —Å—Ü–µ–Ω—ã –∏ –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç `engine.mount()`. –°—Ü–µ–Ω–∞ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.

### ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ

**–§–∞–π–ª—ã, –≥–¥–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- `ui/theme-controller.js` ‚Äî –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç `engine.mount()`
- `ui/themeSwitcher.js` ‚Äî –º–æ–Ω—Ç–∏—Ä—É–µ—Ç —Å—Ü–µ–Ω—É –æ–¥–∏–Ω —Ä–∞–∑ –≤ `initThemeSwitcher()`
- `themes/calm.js` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ü–µ–Ω—ã, –Ω–µ UI-—Ç–µ–º–∞
- `themes/index.js` ‚Äî —Ä–µ–µ—Å—Ç—Ä —Å—Ü–µ–Ω, –Ω–µ UI-—Ç–µ–º

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∞–≤–∏–ª–æ —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è. –°—Ü–µ–Ω–∞ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –≤ `ui/themeSwitcher.js` ‚Üí `mountCalmScene()`, —Ç–µ–º–∞ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç `engine.mount()`.

### ‚ö†Ô∏è –°–æ–º–Ω–µ–Ω–∏—è

**–ù–µ—Ç –Ω–∞—Ä—É—à–µ–Ω–∏–π.**

---

## –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 2: –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã –ø–æ —Ç–µ–º–µ –∏ –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

**–ü—Ä–∞–≤–∏–ª–æ:** –¢–µ–∫—É—â–∞—è —Ç–µ–º–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `activeThemeId` –≤ `core/state.js`. –°–º–µ–Ω–∞ —Ç–µ–º—ã –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ `applyThemeById()` –≤ `ui/theme-controller.js`. –ù–∏–∫–∞–∫–∏–µ –¥—Ä—É–≥–∏–µ –º–æ–¥—É–ª–∏ –Ω–µ –∏–∑–º–µ–Ω—è—é—Ç `.theme-*` –∫–ª–∞—Å—Å—ã –∏ –Ω–µ –ª–µ–∑—É—Ç –Ω–∞–ø—Ä—è–º—É—é –≤ `theme-colors`.

### ‚ùå –ù–∞—Ä—É—à–µ–Ω–∏—è

#### 1. –ü—Ä—è–º–æ–µ —á—Ç–µ–Ω–∏–µ `localStorage.getItem('colorTheme')` –≤ `core/engine.js`

**–§–∞–π–ª:** `core/engine.js`  
**–°—Ç—Ä–æ–∫–∏:** 43, 165

**–ü—Ä–æ–±–ª–µ–º–∞:**
```javascript
// –°—Ç—Ä–æ–∫–∞ 43
const savedTheme = typeof localStorage !== 'undefined' ? localStorage.getItem('colorTheme') : 'dark';
// ...
sceneBg = savedTheme === 'light' ? '#FFFFFF' : '#0B0F14';

// –°—Ç—Ä–æ–∫–∞ 165
const currentTheme = typeof document !== 'undefined' && document.body.classList.contains('theme-light') ? 'light' : 'dark';
const sceneBg = getComputedStyle(document.documentElement).getPropertyValue('--scene-bg').trim() || (currentTheme === 'light' ? '#FFFFFF' : '#0B0F14');
```

**–ü–æ—á–µ–º—É –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ:** `core/engine.js` —á–∏—Ç–∞–µ—Ç —Ç–µ–º—É –Ω–∞–ø—Ä—è–º—É—é –∏–∑ `localStorage` –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–ª–∞—Å—Å—ã `.theme-light` –¥–ª—è fallback-–∑–Ω–∞—á–µ–Ω–∏–π. –≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ñ–æ—Ä–º–∞—Ç–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–º—ã –∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –µ—Å–ª–∏ —Ñ–æ—Ä–º–∞—Ç –∏–∑–º–µ–Ω–∏—Ç—Å—è.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `getCurrentThemeId()` –∏–∑ `ui/theme-controller.js` –∏–ª–∏ —á–∏—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑ CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –±–µ–∑ fallback –∫ `localStorage`.

#### 2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–º–ø–æ—Ä—Ç–∞ `emit` –≤ `ui/theme-controller.js`

**–§–∞–π–ª:** `ui/theme-controller.js`  
**–°—Ç—Ä–æ–∫–∞:** 145

**–ü—Ä–æ–±–ª–µ–º–∞:**
```javascript
// –°—Ç—Ä–æ–∫–∞ 8: –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ set, get
import { set, get } from '../core/state.js';

// –°—Ç—Ä–æ–∫–∞ 145: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è emit, –Ω–æ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω
emit('themeChanged', { themeId, themeConfig });
```

**–ü–æ—á–µ–º—É –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ:** –≠—Ç–æ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ runtime error `ReferenceError: emit is not defined` –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `applyThemeById()`.

**–°—Ç–∞—Ç—É—Å:** ‚ùå **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞** ‚Äî –∫–æ–¥ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.

### ‚ö†Ô∏è –°–æ–º–Ω–µ–Ω–∏—è

#### 1. –ü—Ä—è–º–æ–µ —á—Ç–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–µ–º—ã –≤ fallback-–∑–Ω–∞—á–µ–Ω–∏—è—Ö

**–§–∞–π–ª—ã:** `core/hud-manager.js` (—Å—Ç—Ä–æ–∫–∏ 96-97, 468-469, 477-478)

**–ü—Ä–æ–±–ª–µ–º–∞:** –í fallback-–∑–Ω–∞—á–µ–Ω–∏—è—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä—è–º–æ–µ —á—Ç–µ–Ω–∏–µ CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å fallback –∫ hex-–∑–Ω–∞—á–µ–Ω–∏—è–º. –≠—Ç–æ –¥–æ–ø—É—Å—Ç–∏–º–æ, –Ω–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `getCurrentThemeId()` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–µ–º—ã.

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è fallback –≤ inline-—Å—Ç–∏–ª—è—Ö.

---

## –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 3: –¢—É—Ä –∏ –¥–µ–º–æ –Ω–µ –º–µ–Ω—è—é—Ç —Ç–µ–º—É –∏ –Ω–µ –º–æ–Ω—Ç–∏—Ä—É—é—Ç —Å—Ü–µ–Ω—É

**–ü—Ä–∞–≤–∏–ª–æ:** –ú–æ–¥—É–ª–∏ —Ç—É—Ä–∞ –∏ –¥–µ–º–æ –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç `applyThemeById()`, `engine.mount()` –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.

### ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ

**–§–∞–π–ª—ã, –≥–¥–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- `index.html` (–ª–æ–≥–∏–∫–∞ —Ç—É—Ä–∞) ‚Äî –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç `applyThemeById()`, `toggleTheme()`, `engine.mount()`
- `core/hud-manager.js` (–∫–Ω–æ–ø–∫–∞ "–î–µ–º–æ") ‚Äî –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ —Å–º–µ–Ω—ã —Ç–µ–º—ã –∏–ª–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ü–µ–Ω—ã

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∞–≤–∏–ª–æ —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è. –¢—É—Ä —Ç–æ–ª—å–∫–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å–∞–º–∏ `tour-active`, –¥–µ–º–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç HUD –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã.

### ‚ö†Ô∏è –°–æ–º–Ω–µ–Ω–∏—è

#### 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç—å—é –∫–Ω–æ–ø–∫–∏ —Ç–µ–º—ã –≤ –ª–æ–≥–∏–∫–µ —Ç—É—Ä–∞

**–§–∞–π–ª:** `index.html`  
**–°—Ç—Ä–æ–∫–∏:** 2650-2657, 2727-2734, 3477-3486

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –ª–æ–≥–∏–∫–µ —Ç—É—Ä–∞ –µ—Å—Ç—å –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å—é –∫–Ω–æ–ø–∫–∏ —Ç–µ–º—ã (`theme-toggle-btn`):
```javascript
// CRITICAL: Always ensure theme-toggle-btn is visible (never hide it)
const themeBtn = document.getElementById('theme-toggle-btn');
if (themeBtn) {
  themeBtn.style.display = 'inline-flex';
  themeBtn.style.visibility = 'visible';
  themeBtn.style.opacity = '1';
  themeBtn.style.pointerEvents = 'auto';
}
```

**–ü–æ—á–µ–º—É –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ:** –¢—É—Ä –Ω–µ –¥–æ–ª–∂–µ–Ω —É–ø—Ä–∞–≤–ª—è—Ç—å UI-—ç–ª–µ–º–µ–Ω—Ç–∞–º–∏, –Ω–µ —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ —Å —Ç—É—Ä–æ–º. –≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç —Å–≤—è–∑—å –º–µ–∂–¥—É —Ç—É—Ä–æ–º –∏ —Å–∏—Å—Ç–µ–º–æ–π —Ç–µ–º, —á—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ù–∞—Ä—É—à–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏** ‚Äî —Ç—É—Ä –Ω–µ –¥–æ–ª–∂–µ–Ω —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–Ω–æ–ø–∫–æ–π —Ç–µ–º—ã.

---

## –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 4: UI –Ω–µ –∑–Ω–∞–µ—Ç –¥–µ—Ç–∞–ª–µ–π –¥–≤–∏–∂–∫–∞

**–ü—Ä–∞–≤–∏–ª–æ:** UI-–∫–æ–¥ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –∏ –Ω–µ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç engine –Ω–∞–ø—Ä—è–º—É—é. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∏–¥—ë—Ç —á–µ—Ä–µ–∑ —Ñ–∞—Å–∞–¥—ã.

### ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ

**–§–∞–π–ª—ã, –≥–¥–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- `core/hud-manager.js` ‚Äî –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç `createEngine()` –∏–ª–∏ `engine.mount()`
- `ui/theme-controller.js` ‚Äî –ø–æ–ª—É—á–∞–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ engine —á–µ—Ä–µ–∑ `setEngine()`, –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –µ–≥–æ

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∞–≤–∏–ª–æ —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è. UI –ø–æ–ª—É—á–∞–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ engine —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π.

### ‚ö†Ô∏è –°–æ–º–Ω–µ–Ω–∏—è

**–ù–µ—Ç –Ω–∞—Ä—É—à–µ–Ω–∏–π.**

---

## –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 5: –¶–≤–µ—Ç–∞ —Ç–æ–ª—å–∫–æ –∏–∑ —Ç–æ–∫–µ–Ω–æ–≤/—Ç–µ–º, –±–µ–∑ "–∂—ë—Å—Ç–∫–∏—Ö" hex –≤ –±–æ–µ–≤–æ–º –∫–æ–¥–µ

**–ü—Ä–∞–≤–∏–ª–æ:** UI-—Ü–≤–µ—Ç–∞ –±–µ—Ä—É—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑ `styles/tokens.css` –∏/–∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥–æ–≤ —Ç–µ–º—ã. –¶–≤–µ—Ç–∞ –¥–ª—è 3D-—Å—Ü–µ–Ω—ã –±–µ—Ä—É—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑ `core/theme-colors.js`. –í –±–æ–µ–≤–æ–º –∫–æ–¥–µ –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Ä—É—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `#xxxxxx`, `rgb(...)`, `new Color('red')`.

### ‚ùå –ù–∞—Ä—É—à–µ–Ω–∏—è

#### 1. –ü—Ä—è–º—ã–µ hex-–∑–Ω–∞—á–µ–Ω–∏—è –≤ `index.html` (inline-—Å—Ç–∏–ª–∏)

**–§–∞–π–ª:** `index.html`  
**–°—Ç—Ä–æ–∫–∏:** 10-23, 61-62, 269, 275, 277, 283, 286, 299, 355, 399-401, 424-425, 455, 472, 481, 606, 614, 620, 638, 671-678, 713, 743, 746-747, 771-772, 777, 781, 797

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä—è–º—ã—Ö hex/rgb –∑–Ω–∞—á–µ–Ω–∏–π –≤ inline-—Å—Ç–∏–ª—è—Ö:
- `--critical-bg: #0B0F14;` (—Å—Ç—Ä–æ–∫–∞ 10)
- `--critical-text: #E6EEF8;` (—Å—Ç—Ä–æ–∫–∞ 11)
- `content="#0B0F14"` (—Å—Ç—Ä–æ–∫–∏ 61-62)
- `color: #CFE8FF !important;` (—Å—Ç—Ä–æ–∫–∞ 455)
- `background: rgba(91,156,255,0.08);` (—Å—Ç—Ä–æ–∫–∞ 638)
- –ò –º–Ω–æ–≥–∏–µ –¥—Ä—É–≥–∏–µ

**–ü–æ—á–µ–º—É –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ:** –≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ `styles/tokens.css` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. –ò—Å–∫–ª—é—á–µ–Ω–∏–µ ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ inline-—Å—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è FOUC, –Ω–æ –¥–∞–∂–µ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å fallback.

**–°—Ç–∞—Ç—É—Å:** ‚ùå **–ù–∞—Ä—É—à–µ–Ω–∏–µ** ‚Äî –ø—Ä—è–º—ã–µ hex/rgb –∑–Ω–∞—á–µ–Ω–∏—è –≤ –±–æ–µ–≤–æ–º –∫–æ–¥–µ.

#### 2. –ü—Ä—è–º—ã–µ hex-–∑–Ω–∞—á–µ–Ω–∏—è –≤ `core/engine.js` (fallback)

**–§–∞–π–ª:** `core/engine.js`  
**–°—Ç—Ä–æ–∫–∏:** 47, 165, 228-230, 377-379

**–ü—Ä–æ–±–ª–µ–º–∞:**
```javascript
// –°—Ç—Ä–æ–∫–∞ 47
sceneBg = savedTheme === 'light' ? '#FFFFFF' : '#0B0F14';

// –°—Ç—Ä–æ–∫–∞ 165
const sceneBg = getComputedStyle(document.documentElement).getPropertyValue('--scene-bg').trim() || (currentTheme === 'light' ? '#FFFFFF' : '#0B0F14');

// –°—Ç—Ä–æ–∫–∏ 228-230, 377-379
const textMuted = getComputedStyle(document.documentElement).getPropertyValue('--muted').trim() || '#9AA6B2';
const bgOverlay = getComputedStyle(document.documentElement).getPropertyValue('--Color/Dark/Surface/Overlay').trim() || 'rgba(0,0,0,0.5)';
const borderColor = getComputedStyle(document.documentElement).getPropertyValue('--border').trim() || '#243041';
```

**–ü–æ—á–µ–º—É –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ:** Fallback-–∑–Ω–∞—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä—è–º—ã–µ hex/rgb. –õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ `core/theme-colors.js` –∏–ª–∏ —É–±—Ä–∞—Ç—å fallback, –µ—Å–ª–∏ CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω—ã.

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ù–∞—Ä—É—à–µ–Ω–∏–µ** ‚Äî fallback-–∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—Ä–∞—Ç—å—Å—è –∏–∑ —Ç–æ–∫–µ–Ω–æ–≤.

#### 3. –ü—Ä—è–º—ã–µ hex-–∑–Ω–∞—á–µ–Ω–∏—è –≤ `core/hud-manager.js` (fallback)

**–§–∞–π–ª:** `core/hud-manager.js`  
**–°—Ç—Ä–æ–∫–∏:** 96-97, 105, 107, 468-469, 477-478

**–ü—Ä–æ–±–ª–µ–º–∞:**
```javascript
// –°—Ç—Ä–æ–∫–∏ 96-97
tabLink.style.borderBottomColor = accentHover || 'rgba(91,156,255,0.8)';
tabLink.style.color = accentColor || '#5B9CFF';

// –°—Ç—Ä–æ–∫–∏ 105, 107
const borderSubtle = getComputedStyle(document.documentElement).getPropertyValue('--Color/Dark/Border/Subtle').trim() || 'rgba(154,166,178,0.3)';
tabLink.style.color = mutedColor || '#9AA6B2';

// –°—Ç—Ä–æ–∫–∏ 468-469, 477-478 (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ)
```

**–ü–æ—á–µ–º—É –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ:** Fallback-–∑–Ω–∞—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä—è–º—ã–µ hex/rgb. –õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ `core/theme-colors.js` –∏–ª–∏ —É–±—Ä–∞—Ç—å fallback.

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ù–∞—Ä—É—à–µ–Ω–∏–µ** ‚Äî fallback-–∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—Ä–∞—Ç—å—Å—è –∏–∑ —Ç–æ–∫–µ–Ω–æ–≤.

### ‚ö†Ô∏è –°–æ–º–Ω–µ–Ω–∏—è

#### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `rgba()` –≤ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Å—Ç–∏–ª—è—Ö

**–§–∞–π–ª—ã:** `core/engine.js`, `core/hud-manager.js`

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è `rgba()` –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Å—Ç–∏–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ grid debug). –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–ø—É—Å—Ç–∏–º–æ, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏, –Ω–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ** ‚Äî –¥–æ–ø—É—Å—Ç–∏–º–æ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –Ω–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã.

---

## –õ–∏—à–Ω–∏–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞–º–∏

### 1. –¢—É—Ä —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å—é –∫–Ω–æ–ø–∫–∏ —Ç–µ–º—ã

**–§–∞–π–ª:** `index.html`  
**–°—Ç—Ä–æ–∫–∏:** 2650-2657, 2727-2734, 3477-3486

**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–æ–≥–∏–∫–∞ —Ç—É—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç—å—é –∫–Ω–æ–ø–∫–∏ —Ç–µ–º—ã (`theme-toggle-btn`). –≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç –Ω–µ–Ω—É–∂–Ω—É—é —Å–≤—è–∑—å –º–µ–∂–¥—É —Ç—É—Ä–æ–º –∏ —Å–∏—Å—Ç–µ–º–æ–π —Ç–µ–º.

**–ü–æ—á–µ–º—É –ø—Ä–æ–±–ª–µ–º–∞:** –¢—É—Ä –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å –æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–∏ –∫–Ω–æ–ø–∫–∏ —Ç–µ–º—ã. –≠—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í—ã–Ω–µ—Å—Ç–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç—å—é –∫–Ω–æ–ø–∫–∏ —Ç–µ–º—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å –∏–ª–∏ –≤ `core/hud-manager.js`.

### 2. Engine —á–∏—Ç–∞–µ—Ç —Ç–µ–º—É –Ω–∞–ø—Ä—è–º—É—é –∏–∑ localStorage

**–§–∞–π–ª:** `core/engine.js`  
**–°—Ç—Ä–æ–∫–∏:** 43, 165

**–ü—Ä–æ–±–ª–µ–º–∞:** `core/engine.js` —á–∏—Ç–∞–µ—Ç —Ç–µ–º—É –Ω–∞–ø—Ä—è–º—É—é –∏–∑ `localStorage.getItem('colorTheme')` –¥–ª—è fallback-–∑–Ω–∞—á–µ–Ω–∏–π. –≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ñ–æ—Ä–º–∞—Ç–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–º—ã.

**–ü–æ—á–µ–º—É –ø—Ä–æ–±–ª–µ–º–∞:** Engine –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å, –∫–∞–∫ —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–µ–º–∞. –≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç —Å–≤—è–∑—å –º–µ–∂–¥—É engine –∏ —Å–∏—Å—Ç–µ–º–æ–π —Ç–µ–º.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `getCurrentThemeId()` –∏–∑ `ui/theme-controller.js` –∏–ª–∏ —á–∏—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑ CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

### 3. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ MutationObserver –¥–ª—è –∑–∞—â–∏—Ç—ã –∫–Ω–æ–ø–æ–∫

**–§–∞–π–ª—ã:** `index.html`, `core/hud-manager.js`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í `index.html` (—Å—Ç—Ä–æ–∫–∞ 2788) –µ—Å—Ç—å MutationObserver –¥–ª—è –∑–∞—â–∏—Ç—ã `tour-restart-btn`
- –í `core/hud-manager.js` (—Å—Ç—Ä–æ–∫–∞ 1152) –µ—Å—Ç—å MutationObserver –¥–ª—è –∑–∞—â–∏—Ç—ã `theme-toggle-btn`
- –í `index.html` (—Å—Ç—Ä–æ–∫–∏ 4145, 4149, 4163) –µ—Å—Ç—å –µ—â—ë –Ω–µ—Å–∫–æ–ª—å–∫–æ MutationObserver –¥–ª—è grid overlay

**–ü–æ—á–µ–º—É –ø—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ MutationObserver –º–æ–≥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –æ–Ω–∏ —Å–æ–∑–¥–∞—é—Ç –Ω–µ—è–≤–Ω—ã–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç—å—é –∫–Ω–æ–ø–æ–∫ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –º–µ—Ö–∞–Ω–∏–∑–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, CSS –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è/–ø–æ–∫–∞–∑–∞).

---

## –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Ñ–∞–π–ª—ã, –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ

### 1. `themes/theme-variables.css`

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π**

**–ü—Ä–æ–±–ª–µ–º–∞:** –§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ä—ã–µ CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (`--bg-primary`, `--text-primary` –∏ —Ç.–¥.), –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å `styles/tokens.css`.

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
- ‚ùå –ù–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ `index.html`
- ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `styles/main.css`
- ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–∞—Ö

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–¥–∞–ª–∏—Ç—å, –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –≥–¥–µ –∏–º–µ–Ω–Ω–æ, –∏ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ `styles/tokens.css`.

### 2. `themes/simple-themes.css`

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π**

**–ü—Ä–æ–±–ª–µ–º–∞:** –§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–ª—è light –∏ neon —Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
- ‚ùå –ù–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ `index.html`
- ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `styles/main.css`
- ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–∞—Ö

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–¥–∞–ª–∏—Ç—å, –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –≥–¥–µ –∏–º–µ–Ω–Ω–æ, –∏ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ `styles/tokens.css`.

### 3. –£–ø–æ–º–∏–Ω–∞–Ω–∏—è Matrix-—Å—Ü–µ–Ω—ã

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ (–§–∞–∑–∞ 2)** ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ 'matrix' —Ç–µ–º—ã —É–¥–∞–ª–µ–Ω–∞ –∏–∑ `themes/index.js`. –í—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ Matrix-—Å—Ü–µ–Ω—É —É–¥–∞–ª–µ–Ω—ã –∏–∑ –∫–æ–¥–∞.

---

## –õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ç—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –Ω–∞–±–ª—é–¥–∞—Ç—å

### 1. –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π `index.html`

**–ü—Ä–æ–±–ª–µ–º–∞:** `index.html` —Å–æ–¥–µ—Ä–∂–∏—Ç –±–æ–ª—å—à–æ–π –æ–±—ä—ë–º inline JavaScript (–ª–æ–≥–∏–∫–∞ —Ç—É—Ä–∞, bootstrap, —Å–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫). –≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏.

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í—ã–Ω–µ—Å—Ç–∏ –ª–æ–≥–∏–∫—É —Ç—É—Ä–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å (`ui/tour-manager.js`), bootstrap ‚Äî –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª (`core/bootstrap.js`).

### 2. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–Ω–æ–ø–∫–∞ —Ç–µ–º—ã —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ `core/hud-manager.js`
- –ö–Ω–æ–ø–∫–∞ tour-restart —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ `index.html` (bootstrap)

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ header –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ `ui/header-buttons.js`).

### 3. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π —á–µ—Ä–µ–∑ query params

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–≥–∏–µ –∏–º–ø–æ—Ä—Ç—ã –∏–º–µ—é—Ç `?v=XX` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `./core/engine.js?v=37`). –≠—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è cache busting, –Ω–æ —Å–æ–∑–¥–∞—ë—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ.

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ build-–ø—Ä–æ—Ü–µ—Å—Å.

### 4. –ü—Ä—è–º–æ–µ —á—Ç–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–µ–º—ã

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö –∫–æ–¥ —á–∏—Ç–∞–µ—Ç –∫–ª–∞—Å—Å—ã `.theme-light` / `.theme-dark` –Ω–∞–ø—Ä—è–º—É—é –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–µ–º—ã, –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `getCurrentThemeId()`.

**–§–∞–π–ª—ã:** `core/engine.js` (—Å—Ç—Ä–æ–∫–∞ 165), `core/hud-manager.js` (fallback-–∑–Ω–∞—á–µ–Ω–∏—è)

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ù–∞—Ä—É—à–µ–Ω–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞ 2**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `getCurrentThemeId()` –∏–∑ `ui/theme-controller.js` –≤–µ–∑–¥–µ, –≥–¥–µ –Ω—É–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ç–µ–º—É.

---

## –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è

1. ‚ùå **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–º–ø–æ—Ä—Ç–∞ `emit` –≤ `ui/theme-controller.js`** ‚Äî –∫–æ–¥ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
2. ‚ùå **–ü—Ä—è–º—ã–µ hex/rgb –∑–Ω–∞—á–µ–Ω–∏—è –≤ `index.html`** ‚Äî –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞ 5
3. ‚ö†Ô∏è **–ü—Ä—è–º—ã–µ hex/rgb –∑–Ω–∞—á–µ–Ω–∏—è –≤ fallback-–∑–Ω–∞—á–µ–Ω–∏—è—Ö** ‚Äî –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞ 5

### –ù–∞—Ä—É—à–µ–Ω–∏—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

1. ‚ö†Ô∏è **–¢—É—Ä —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å—é –∫–Ω–æ–ø–∫–∏ —Ç–µ–º—ã** ‚Äî –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞ 3
2. ‚ö†Ô∏è **Engine —á–∏—Ç–∞–µ—Ç —Ç–µ–º—É –Ω–∞–ø—Ä—è–º—É—é –∏–∑ localStorage** ‚Äî –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞ 2

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥

1. ‚ö†Ô∏è **–ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π `index.html`** ‚Äî —Ç—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
2. ‚ö†Ô∏è **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫** ‚Äî —Ç—Ä–µ–±—É–µ—Ç —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. ‚ö†Ô∏è **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ MutationObserver** ‚Äî —Ç—Ä–µ–±—É—é—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
4. ‚ö†Ô∏è **–£—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Ñ–∞–π–ª—ã** (`theme-variables.css`, `simple-themes.css`) ‚Äî —Ç—Ä–µ–±—É—é—Ç –∞—É–¥–∏—Ç–∞ –∏ —É–¥–∞–ª–µ–Ω–∏—è

### Legacy —Ü–≤–µ—Ç–∞ (PHASE C4)

**–°—Ç–∞—Ç—É—Å:** –ß–∞—Å—Ç–∏—á–Ω–æ –æ—á–∏—â–µ–Ω–æ

**–§–∞–π–ª—ã:**
- ‚úÖ `styles/variables.css` ‚Äî –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω –≤ —Ç–æ–Ω–∫–∏–π alias-—Å–ª–æ–π (PHASE C4), –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –º–∞–ø–ø—è—Ç—Å—è –Ω–∞ —Ç–æ–∫–µ–Ω—ã
- ‚úÖ `themes/theme-variables.css` ‚Äî **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**, –≥–æ—Ç–æ–≤ –∫ —É–¥–∞–ª–µ–Ω–∏—é
- ‚úÖ `themes/simple-themes.css` ‚Äî **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**, –≥–æ—Ç–æ–≤ –∫ —É–¥–∞–ª–µ–Ω–∏—é

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ legacy-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:**
- ‚ö†Ô∏è `index.html` ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç legacy-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (`--bg`, `--text`, `--panel`, `--accent`, `--border`, `--muted`) –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- ‚úÖ –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (HUD/scene/tour) ‚Äî –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ–ª—å–∫–æ —Ç–æ–∫–µ–Ω—ã –Ω–∞–ø—Ä—è–º—É—é

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∑–∞–º–µ–Ω—è—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ legacy-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ `index.html` –Ω–∞ –ø—Ä—è–º—ã–µ —Ç–æ–∫–µ–Ω—ã
- –ü–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å `styles/variables.css`
- `themes/theme-variables.css` –∏ `themes/simple-themes.css` –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ

### –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞–º

- ‚úÖ **–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 1:** –°–æ–±–ª—é–¥–∞–µ—Ç—Å—è
- ‚ö†Ô∏è **–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 2:** –ù–∞—Ä—É—à–µ–Ω–∏—è –≤ fallback-–∑–Ω–∞—á–µ–Ω–∏—è—Ö –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–º–ø–æ—Ä—Ç–∞ `emit`
- ‚ö†Ô∏è **–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 3:** –ù–∞—Ä—É—à–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (—Ç—É—Ä —É–ø—Ä–∞–≤–ª—è–µ—Ç –∫–Ω–æ–ø–∫–æ–π —Ç–µ–º—ã)
- ‚úÖ **–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 4:** –°–æ–±–ª—é–¥–∞–µ—Ç—Å—è
- ‚ùå **–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 5:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è (–ø—Ä—è–º—ã–µ hex/rgb –∑–Ω–∞—á–µ–Ω–∏—è)

---

**–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω:** –§–∞–∑–∞ 2C (–∞—É–¥–∏—Ç –∫–æ–¥–∞)  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –§–∞–∑–∞ 2D ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã—è–≤–ª–µ–Ω–Ω—ã—Ö –Ω–∞—Ä—É—à–µ–Ω–∏–π

